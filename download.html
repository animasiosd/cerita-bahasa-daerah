<!DOCTYPE html>
<html lang="id">
<head>
    <base href="">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Google Site Verification -->
    <meta name="google-site-verification" content="S545LWpJJUmiJMSHVd_HRpn8JEMyONvPPVRMTV-9FzQ" />

  <!-- Google Tag Manager -->
   <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
   new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
   })(window,document,'script','dataLayer','GTM-MP4G2NCV');</script>
  <!-- End Google Tag Manager -->
    <title>Download | Cerita Bahasa Daerah</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d6efd">

    <style>
        /* Menambahkan gaya untuk loading & login dari halaman lain */
        #page-loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #fff; display: flex; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.75s ease-out; }
        #page-loader.hidden { opacity: 0; pointer-events: none; }
        #loginContainer, #mainContent { display: none; }
        
        /* Gaya khusus untuk tabel agar lebih modern */
        #downloadTable { font-size: 0.9rem; }
        #downloadTable tr:hover { background-color: #e9ecef; cursor: pointer; }
        #downloadTable th { background-color: #f8f9fa; cursor: pointer; }
        /* Membatasi tinggi tabel agar maksimal 15 baris, lalu bisa scroll */
.table-scroll {
  max-height: calc(15 * 2.5em); /* Tinggi baris Â±2.5em */
  overflow-y: auto;
  display: block;
  border: 1px solid #dee2e6;
}

/* Supaya header tabel tetap di atas saat scroll */
.table-scroll thead {
  position: sticky;
  top: 0;
  z-index: 2;
  background-color: #f8f9fa;
}

/* Pastikan kolom tidak mengecil saat scroll */
.table-scroll table {
  width: 100%;
  border-collapse: collapse;
}

.table-scroll td,
.table-scroll th {
  padding: 10px;
  text-align: left;
  vertical-align: middle;
  white-space: nowrap;
}
        .sortable::after { content: " \2195"; color: #aaa; }
        .asc::after { content: " \2191"; }
        .desc::after { content: " \2193"; }
    </style>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
     <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MP4G2NCV"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="navbar-placeholder"></div>

    <div id="page-loader" class="d-flex justify-content-center align-items-center">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Memuat...</span>
        </div>
    </div>

    <div id="loginContainer" class="d-flex justify-content-center align-items-center vh-100">
        <div class="text-center">
            <h1 class="mb-3">Download Video</h1>
            <p class="mb-4">Masuk untuk melihat dan mengunduh video cerita.</p>
            <p class="text-danger bg-white p-2 rounded">Anda harus login terlebih dahulu untuk mengakses halaman ini.</p>
            <button id="loginBtn" class="btn btn-primary btn-lg">Login dengan Google</button>
        </div>
    </div>

    <div id="mainContent">
        <main class="container my-4">
            <h1 class="text-center">Download Video Cerita</h1>
            
            <p class="text-center mb-4">
                Silahkan klik salah satu daftar untuk mendownload video atau Anda bisa memfilternya berdasarkan kategori di bawah.
            </p>

            <div class="filter-group d-flex justify-content-center flex-wrap gap-2 mb-4">
                <select id="filterBahasa" class="form-select w-auto"><option value="">Semua Bahasa</option></select>
                <select id="filterUrutan" class="form-select w-auto"><option value="">Semua Urutan</option></select>
                <select id="filterJudul" class="form-select w-auto"><option value="">Semua Judul</option></select>
                <button id="resetFilters" class="btn btn-outline-secondary">Reset Filter</button>
                <button id="resetSort" class="btn btn-outline-secondary">Reset Urutan</button>
            </div>

            <div class="table-responsive table-scroll">
                <table id="downloadTable" class="table table-bordered table-hover mb-0">
                    <thead>
                        <tr>
                            <th class="sortable" data-key="bahasa">Bahasa</th>
                            <th class="sortable" data-key="urutan">Urutan</th>
                            <th class="sortable" data-key="title">Judul</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.8.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.8.1/firebase-auth-compat.js"></script>

<script src="js/load_data/user_data_service.js"></script>
<script src="js/load_data/api_service.js"></script>
<script src="js/send_data/analytics_service.js"></script>

<script src="js/events.js"></script>
<script src="js/ui/common.js"></script>
<script src="js/ui/page_auth.js"></script>
<script src="js/ui/page_download.js"></script>
<script src="js/footer.js"></script>

<script>
  // Definisikan initPage agar bisa dipanggil oleh managePageAccess
  const initPage = initializeDownloadPage;

  document.addEventListener('DOMContentLoaded', () => {
    initializeNavbar();
    managePageAccess(); 
  });
</script>
</body>
</html>